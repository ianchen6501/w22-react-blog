{"version":3,"sources":["utils.js","WebAPI.js","pages/HomePage/HomePage.js","contexts.js","pages/LoginPage/LoginPage.js","components/Header/Header.js","components/App/App.js","index.js"],"names":["TOKEN_NAME","setAuthToken","token","localStorage","setItem","BASE_URL","getMe","getItem","fetch","headers","then","res","json","Root","styled","div","PostContainer","PostTitle","Link","PostDate","Post","post","to","id","title","Date","createdAt","toLocaleDateString","HomePage","useState","posts","setPosts","useEffect","map","AuthContext","createContext","ErrorMessage","LoginPage","setUser","useContext","username","setUsername","password","setPassword","errorMessage","setErrormessage","history","useHistory","onSubmit","event","preventDefault","method","body","JSON","stringify","login","data","ok","message","response","toString","push","type","value","onChange","e","target","HeaderContainer","Brand","NavbarList","Nav","props","$active","LeftContainer","Header","location","useLocation","user","pathname","onClick","App","Provider","exact","path","ReactDOM","render","theme","colors","red_300","red_400","red_500","document","getElementById"],"mappings":"wMAAMA,EAAa,QAENC,EAAe,SAACC,GAC3BC,aAAaC,QAAQJ,EAAYE,ICD7BG,EAAW,qCAqBJC,EAAQ,WACnB,IAAMJ,EDjBCC,aAAaI,QAAQP,GCkB5B,OAAOQ,MAAM,GAAD,OAAIH,EAAJ,OAAmB,CAC7BI,QAAS,CACP,cAAgB,UAAhB,OAA2BP,MAG9BQ,MAAK,SAAAC,GAAG,OAAIA,EAAIC,W,6iBCtBnB,IAAMC,EAAOC,IAAOC,IAAV,KAKJC,EAAgBF,IAAOC,IAAV,KAQbE,EAAYH,YAAOI,IAAPJ,CAAH,KAMTK,EAAWL,IAAOC,IAAV,KAId,SAASK,EAAT,GAAuB,IAARC,EAAO,EAAPA,KACb,OACE,eAACL,EAAD,WACE,cAACC,EAAD,CAAWK,GAAE,iBAAYD,EAAKE,IAA9B,SAAqCF,EAAKG,QAC1C,cAACL,EAAD,UAAW,IAAIM,KAAKJ,EAAKK,WAAWC,0BAS3B,SAASC,IAAY,IAAD,EACPC,mBAAS,IADF,mBAC1BC,EAD0B,KACnBC,EADmB,KAOjC,OAJAC,qBAAU,WDzCHxB,MAAM,GAAD,OAAIH,EAAJ,uCAAkDK,MAAK,SAACC,GAAD,OAASA,EAAIC,UC0CnEF,MAAK,SAAAoB,GAAK,OAAIC,EAASD,SAIlC,cAACjB,EAAD,UACIiB,EAAMG,KAAI,SAAAZ,GAAI,OAAI,cAACD,EAAD,CAAMC,KAAMA,GAAWA,EAAKE,SCnD/C,IAAMW,EAAcC,wBAAc,M,sFCKzC,IAAMC,EAAetB,IAAOC,IAAV,KAIH,SAASsB,IAAa,IAC3BC,EAAYC,qBAAWL,GAAvBI,QAD0B,EAEFT,mBAAS,IAFP,mBAE3BW,EAF2B,KAEjBC,EAFiB,OAGFZ,mBAAS,IAHP,mBAG3Ba,EAH2B,KAGjBC,EAHiB,OAIMd,mBAAS,IAJf,mBAI3Be,EAJ2B,KAIbC,EAJa,KAK5BC,EAAUC,cAsBhB,OACE,uBAAMC,SArBa,SAACC,GACpBJ,EAAgB,MAChBI,EAAMC,iBHXW,SAACV,EAAUE,GAC9B,OAAOlC,MAAM,GAAD,OAAIH,EAAJ,UAAsB,CAChC8C,OAAQ,OACR1C,QAAS,CACP,eAAgB,oBAElB2C,KAAMC,KAAKC,UAAU,CACnBd,WACAE,eAGHhC,MAAK,SAAAC,GAAG,OAAIA,EAAIC,UGCf2C,CAAMf,EAAUE,GAAUhC,MAAK,SAAA8C,GAC7B,GAAe,IAAZA,EAAKC,GACN,OAAOZ,EAAgBW,EAAKE,SAE9BzD,EAAauD,EAAKtD,OAElBI,IAAQI,MAAK,SAAAiD,GACX,GAAoB,IAAhBA,EAASF,GAEX,OADAxD,EAAa,MACN4C,EAAgBc,EAASC,YAElCtB,EAAQqB,EAASH,MACjBV,EAAQe,KAAK,YAMjB,UACE,4CACY,IACV,uBAAOC,KAAK,OAAOC,MAAOvB,EAAUwB,SAAU,SAACC,GAAD,OAAOxB,EAAYwB,EAAEC,OAAOH,aAE5E,4CACY,IACV,uBAAOD,KAAK,OAAOC,MAAOrB,EAAUsB,SAAU,SAACC,GAAD,OAAOtB,EAAYsB,EAAEC,OAAOH,aAE5E,kDACEnB,GAAgB,cAACR,EAAD,UAAeQ,O,29BCvCvC,IAAMuB,EAAiBrD,IAAOC,IAAT,KAefqD,EAAQtD,IAAOC,IAAV,KAKLsD,EAAavD,IAAOC,IAAV,KAKVuD,EAAMxD,YAAOI,IAAPJ,CAAH,KAWL,SAACyD,GAAD,OACAA,EAAMC,SAAN,gCAIEC,EAAgB3D,IAAOC,IAAV,IAIfsD,GAKW,SAASK,IACtB,IAAMC,EAAWC,cACX9B,EAAUC,cAFe,EAGLR,qBAAWL,GAA7B2C,EAHuB,EAGvBA,KAAMvC,EAHiB,EAGjBA,QAUd,OACE,eAAC6B,EAAD,WACE,eAACM,EAAD,WACE,cAACL,EAAD,mDACA,eAACC,EAAD,WACE,cAACC,EAAD,CAAKhD,GAAG,IAAIkD,QAA+B,MAAtBG,EAASG,SAA9B,0BACED,GAAQ,cAACP,EAAD,CAAKhD,GAAG,YAAYkD,QAA+B,cAAtBG,EAASG,SAAtC,4CAGd,cAACT,EAAD,UACKQ,EACH,cAACP,EAAD,CAAKS,QAnBU,WACnB9E,EAAa,IACbqC,EAAQ,MACiB,MAAtBqC,EAASG,UACVhC,EAAQe,KAAK,MAeX,0BADS,cAACS,EAAD,CAAKhD,GAAG,SAASkD,QAA+B,WAAtBG,EAASG,SAAnC,+B,6FCtEjB,IAAMjE,EAAOC,IAAOC,IAAV,KAIK,SAASiE,IAAO,IAAD,EACJnD,mBAAS,MADL,mBACrBgD,EADqB,KACfvC,EADe,KAa5B,OAVAN,qBAAU,WACL7B,aAAaI,QAAQ,UACtBD,IAAQI,MAAK,SAAAiD,GACRA,EAASF,IACVnB,EAAQqB,EAASH,WAItB,IAGD,cAACtB,EAAY+C,SAAb,CAAsBlB,MAAO,CAACc,OAAMvC,WAApC,SACE,cAAC,EAAD,UACE,eAAC,IAAD,WACE,cAACoC,EAAD,IACA,eAAC,IAAD,WACE,cAAC,IAAD,CAAOQ,OAAK,EAACC,KAAK,IAAlB,SACE,cAACvD,EAAD,MAEF,cAAC,IAAD,CAAOsD,OAAK,EAACC,KAAK,SAAlB,SACE,cAAC9C,EAAD,gBC1Bd+C,IAASC,OACP,cAAC,IAAD,CAAeC,MATH,CACZC,OAAS,CACPC,QAAS,UACTC,QAAS,UACTC,QAAS,YAKX,SACI,cAACV,EAAD,MAEJW,SAASC,eAAe,W","file":"static/js/main.ab2ef41c.chunk.js","sourcesContent":["const TOKEN_NAME = 'token'\r\n\r\nexport const setAuthToken = (token) => {\r\n  localStorage.setItem(TOKEN_NAME, token)\r\n}\r\n\r\nexport const getAuthToken = () => {\r\n  return localStorage.getItem(TOKEN_NAME)\r\n}","import { getAuthToken } from './utils'\r\n\r\nconst BASE_URL = 'https://student-json-api.lidemy.me'\r\n\r\n\r\nexport const getPosts = () => {\r\n  return fetch(`${BASE_URL}/posts?_sort=createdAt&_order=dest`).then((res) => res.json())\r\n}\r\n\r\nexport const login = (username, password) => {\r\n  return fetch(`${BASE_URL}/login`, {\r\n    method: 'POST',\r\n    headers: {\r\n      'content-type': 'application/json'\r\n    },\r\n    body: JSON.stringify({\r\n      username,\r\n      password,\r\n    })\r\n  })\r\n  .then(res => res.json())\r\n}\r\n\r\nexport const getMe = () => {\r\n  const token = getAuthToken()\r\n  return fetch(`${BASE_URL}/me`, {\r\n    headers: {\r\n      'authorization': `Bearer ${token}`\r\n    }\r\n  })\r\n  .then(res => res.json())\r\n}","import React, { useEffect, useState } from \"react\"\nimport styled from \"styled-components\"\nimport PropTypes from \"prop-types\"\nimport {\n  Link\n} from \"react-router-dom\";\nimport {getPosts} from '../../WebAPI'\n\nconst Root = styled.div `\n  width: 80%;\n  margin: 0 auto;\n`\n\nconst PostContainer = styled.div `\n  border-bottom: 1px solid rgba(0, 12, 34, 0.2);\n  padding: 16px;\n  display: flex;\n  align-items: flex-end;\n  justify-content: space-between;\n`\n\nconst PostTitle = styled(Link) `\n  font-size: 24px;\n  text-decoration: none;\n  color: #333;\n`\n\nconst PostDate = styled.div `\n  color: rgba(0, 0, 0, 0.8);\n`\n\nfunction Post({post}) {\n  return (\n    <PostContainer>\n      <PostTitle to={`/posts/${post.id}`}>{post.title}</PostTitle>\n      <PostDate>{new Date(post.createdAt).toLocaleDateString()}</PostDate>\n    </PostContainer>\n  )\n}\n\nPost.propTypes = {\n  post: PropTypes.object\n}\n\nexport default function HomePage() {\n  const [posts, setPosts] = useState([])\n  \n  useEffect(() => {\n    getPosts().then(posts => setPosts(posts))\n  })\n\n  return (\n    <Root>\n      { posts.map(post => <Post post={post} key={post.id}></Post>) }\n      \n    </Root>\n  )\n}\n","import { createContext } from 'react'\r\n\r\nexport const AuthContext = createContext(null)\r\n","import React, { useState, useContext } from \"react\"\nimport styled from \"styled-components\"\nimport { login, getMe } from '../../WebAPI'\nimport { setAuthToken } from '../../utils'\nimport { useHistory } from 'react-router-dom'\nimport { AuthContext } from '../../contexts'\n\nconst ErrorMessage = styled.div `\n  color: red;\n`\n\nexport default function LoginPage() {\n  const { setUser } = useContext(AuthContext)\n  const [username, setUsername] = useState('')\n  const [password, setPassword] = useState('')\n  const [errorMessage, setErrormessage] = useState('')\n  const history = useHistory()\n\n  const handleSubmit = (event) => {\n    setErrormessage(null)\n    event.preventDefault()\n    login(username, password).then(data => {\n      if(data.ok === 0) {\n        return setErrormessage(data.message)\n      }\n      setAuthToken(data.token)\n\n      getMe().then(response => {\n        if (response.ok !== 1) {\n          setAuthToken(null)\n          return setErrormessage(response.toString())\n        }\n        setUser(response.data)\n        history.push('/')\n      })\n    })\n  }\n\n  return (\n    <form onSubmit={handleSubmit}>\n      <div>\n        username:{\" \"}\n        <input type=\"text\" value={username} onChange={(e) => setUsername(e.target.value)}></input>\n      </div>\n      <div>\n        password:{\" \"}\n        <input type=\"text\" value={password} onChange={(e) => setPassword(e.target.value)}></input>\n      </div>\n      <button>登入</button>\n      { errorMessage && <ErrorMessage>{errorMessage}</ErrorMessage> }\n    </form>\n  )\n}","import React, { useContext } from \"react\"\nimport styled from \"styled-components\"\nimport {\n  Link,\n  useLocation\n} from \"react-router-dom\";\nimport { AuthContext } from '../../contexts'\nimport { setAuthToken } from '../../utils'\nimport { useHistory } from 'react-router-dom'\n\nconst HeaderContainer =styled.div `\n  height: 64px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  right: 0;\n  left: 0;\n  top: 0;\n  bottom: 0;\n  position: fixed;\n  border-bottom: solid 0.1px rgb(0,0,0,0.2);\n  padding: 0px, 30px\n  background: rgb(5,5,5,0.2)\n`\n\nconst Brand = styled.div `\n  font-size: 32px;\n  font-weight: bold;\n`\n\nconst NavbarList = styled.div `\n  display: flex;\n  align-items: center;\n`\n\nconst Nav = styled(Link) ` \n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 64px;\n  box-sizing: border-box;\n  width: 100px;\n  cursor: pointer;\n  color: black;\n  text-decoration: none;\n\n  ${(props) => \n    props.$active && `background: rgb(0,0,0,0.2)`\n  }\n`\n\nconst LeftContainer = styled.div `\n  display: flex;\n  align-items: center;\n\n  ${NavbarList} {\n    margin-left: 32px;\n  }\n`\n\nexport default function Header() {\n  const location = useLocation()\n  const history = useHistory()\n  const { user, setUser } = useContext(AuthContext)\n\n  const handleLogout = () => {\n    setAuthToken('')\n    setUser(null)\n    if(location.pathname !== \"/\") {\n      history.push('/')\n    }\n  }\n\n  return (\n    <HeaderContainer>\n      <LeftContainer>\n        <Brand>小明的部落格</Brand>\n        <NavbarList>\n          <Nav to='/' $active={location.pathname === '/'} >首頁</Nav>\n          { user && <Nav to='/new-post' $active={location.pathname === '/new-post'}>發布文章</Nav> }\n        </NavbarList>\n      </LeftContainer>\n      <NavbarList>\n        { !user? <Nav to='/login' $active={location.pathname === '/login'}>登入</Nav> :\n        <Nav onClick={handleLogout}>登出</Nav>\n      }\n      </NavbarList>\n    </HeaderContainer>\n  )\n}\n","import React, { useState, useEffect } from \"react\"\nimport styled from \"styled-components\"\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n} from \"react-router-dom\";\nimport HomePage from '../../pages/HomePage'\nimport LoginPage from '../../pages/LoginPage'\nimport Header from '../Header'\nimport { AuthContext } from \"../../contexts\";\nimport { getMe } from \"../../WebAPI\"\n\nconst Root = styled.div `\n  padding-top: 64px;\n`\n\nexport default function App() {\n  const [user, setUser] = useState(null)\n\n  useEffect(() => {\n    if(localStorage.getItem('token')) {\n      getMe().then(response => {\n        if(response.ok) {\n          setUser(response.data)\n        }\n      })\n    }\n  }, [])\n\n  return (\n    <AuthContext.Provider value={{user, setUser}}>\n      <Root>\n        <Router>\n          <Header />\n          <Switch>\n            <Route exact path=\"/\"> \n              <HomePage />\n            </Route>\n            <Route exact path=\"/login\">\n              <LoginPage />\n            </Route>\n          </Switch>\n        </Router>\n      </Root>\n    </AuthContext.Provider>\n  )\n}","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './components/App';\nimport { ThemeProvider } from \"styled-components\"; //一個 <ThemeProvider>的外層 Component 來實踐換網站主題設計的系統\n\nconst theme = {\n  colors : {\n    red_300: '#c02828',\n    red_400: '#ffa7a7',\n    red_500: '#ff4949',\n  }\n}\n\nReactDOM.render(\n  <ThemeProvider theme={theme}>\n      <App />\n  </ThemeProvider>,\n  document.getElementById('root')\n);\n\n"],"sourceRoot":""}